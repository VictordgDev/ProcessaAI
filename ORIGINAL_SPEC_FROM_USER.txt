Aqui est√° a estrutura completa do projeto:
üìÅ Estrutura do Projeto
Copy
document-comparator/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI app
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py            # Pydantic models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file_extractor.py # Extrai texto de PDF/Word
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ comparator.py     # L√≥gica de compara√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ file_handler.py   # Upload/salvar arquivos
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FileUploader.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ComparisonView.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DiffHighlighter.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useComparison.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îî‚îÄ‚îÄ tailwind.config.js
‚îî‚îÄ‚îÄ docker-compose.yml
üîß Backend (Python/FastAPI)
Python
Copy
# backend/requirements.txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
python-multipart==0.0.6
python-docx==1.1.0
PyMuPDF==1.23.8
pydantic==2.5.0
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
diff-match-patch==20230430
Python
Copy
# backend/app/models.py
from pydantic import BaseModel
from typing import List, Optional, Literal
from enum import Enum

class ChangeType(str, Enum):
    INSERTED = "inserted"
    DELETED = "deleted"
    UNCHANGED = "unchanged"
    MODIFIED = "modified"

class DiffBlock(BaseModel):
    type: ChangeType
    left_content: Optional[str]
    right_content: Optional[str]
    left_start: int
    left_end: int
    right_start: int
    right_end: int

class ComparisonResult(BaseModel):
    similarity_score: float  # 0-100%
    total_changes: int
    additions: int
    deletions: int
    modifications: int
    diff_blocks: List[DiffBlock]
    left_text: str
    right_text: str
    processing_time_ms: float

class FileUploadResponse(BaseModel):
    file_id: str
    filename: str
    file_type: Literal["pdf", "docx"]
    text_preview: str
    char_count: int
Python
Copy
# backend/app/services/file_extractor.py
import fitz  # PyMuPDF
from docx import Document
from io import BytesIO
from typing import Tuple
import re

class FileExtractor:
    @staticmethod
    def extract_pdf(content: bytes) -> str:
        """Extrai texto de PDF mantendo formata√ß√£o estrutural."""
        text_parts = []
        with fitz.open(stream=content, filetype="pdf") as doc:
            for page_num, page in enumerate(doc):
                text = page.get_text()
                # Preserva quebras de par√°grafo e estrutura
                text_parts.append(f"\n--- Page {page_num + 1} ---\n")
                text_parts.append(text)
        return "\n".join(text_parts)

    @staticmethod
    def extract_docx(content: bytes) -> str:
        """Extrai texto de DOCX preservando estrutura de par√°grafos."""
        doc = Document(BytesIO(content))
        paragraphs = []
        
        for para in doc.paragraphs:
            if para.text.strip():
                paragraphs.append(para.text)
        
        # Extrai tamb√©m de tabelas
        for table in doc.tables:
            for row in table.rows:
                row_text = " | ".join(cell.text.strip() for cell in row.cells if cell.text.strip())
                if row_text:
                    paragraphs.append(row_text)
        
        return "\n\n".join(paragraphs)

    @staticmethod
    def clean_text(text: str) -> str:
        """Normaliza texto para compara√ß√£o."""
        # Remove espa√ßos m√∫ltiplos mas preserva estrutura
        text = re.sub(r'[ \t]+', ' ', text)
        # Normaliza quebras de linha
        text = re.sub(r'\n{3,}', '\n\n', text)
        return text.strip()
Python
Copy
# backend/app/services/comparator.py
import difflib
import time
from typing import List, Tuple
from diff_match_patch import diff_match_patch
from ..models import ComparisonResult, DiffBlock, ChangeType

class DocumentComparator:
    def __init__(self):
        self.dmp = diff_match_patch()
    
    def compare(self, text1: str, text2: str) -> ComparisonResult:
        start_time = time.time()
        
        # Usa SequenceMatcher para an√°lise de similaridade geral
        sm = difflib.SequenceMatcher(None, text1, text2)
        similarity = sm.ratio() * 100
        
        # Usa diff_match_patch para granularidade fina
        diffs = self.dmp.diff_main(text1, text2)
        self.dmp.diff_cleanupSemantic(diffs)
        
        diff_blocks = self._build_diff_blocks(diffs, text1, text2)
        
        additions = sum(1 for d in diff_blocks if d.type == ChangeType.INSERTED)
        deletions = sum(1 for d in diff_blocks if d.type == ChangeType.DELETED)
        modifications = sum(1 for d in diff_blocks if d.type == ChangeType.MODIFIED)
        
        processing_time = (time.time() - start_time) * 1000
        
        return ComparisonResult(
            similarity_score=round(similarity, 2),
            total_changes=len(diff_blocks),
            additions=additions,
            deletions=deletions,
            modifications=modifications,
            diff_blocks=diff_blocks,
            left_text=text1,
            right_text=text2,
            processing_time_ms=round(processing_time, 2)
        )
    
    def _build_diff_blocks(self, diffs, text1: str, text2: str) -> List[DiffBlock]:
        """Constr√≥i blocos de diff estruturados."""
        blocks = []
        left_pos = 0
        right_pos = 0
        
        for op, data in diffs:
            length = len(data)
            
            if op == 0:  # EQUAL
                block = DiffBlock(
                    type=ChangeType.UNCHANGED,
                    left_content=data,
                    right_content=data,
                    left_start=left_pos,
                    left_end=left_pos + length,
                    right_start=right_pos,
                    right_end=right_pos + length
                )
                left_pos += length
                right_pos += length
                
            elif op == -1:  # DELETE
                block = DiffBlock(
                    type=ChangeType.DELETED,
                    left_content=data,
                    right_content=None,
                    left_start=left_pos,
                    left_end=left_pos + length,
                    right_start=right_pos,
                    right_end=right_pos
                )
                left_pos += length
                
            else:  # INSERT (op == 1)
                block = DiffBlock(
                    type=ChangeType.INSERTED,
                    left_content=None,
                    right_content=data,
                    left_start=left_pos,
                    left_end=left_pos,
                    right_start=right_pos,
                    right_end=right_pos + length
                )
                right_pos += length
            
            # Agrupa modifica√ß√µes (delete + insert consecutivos)
            if blocks and blocks[-1].type == ChangeType.DELETED and block.type == ChangeType.INSERTED:
                # Converte para MODIFIED
                last = blocks[-1]
                blocks[-1] = DiffBlock(
                    type=ChangeType.MODIFIED,
                    left_content=last.left_content,
                    right_content=block.right_content,
                    left_start=last.left_start,
                    left_end=last.left_end,
                    right_start=block.right_start,
                    right_end=block.right_end
                )
            else:
                blocks.append(block)
        
        return blocks
    
    def generate_redline_html(self, result: ComparisonResult, side: str = "both") -> dict:
        """Gera HTML estilo 'redline' para visualiza√ß√£o."""
        if side == "left":
            return self._render_side(result.diff_blocks, "left")
        elif side == "right":
            return self._render_side(result.diff_blocks, "right")
        else:
            return {
                "left": self._render_side(result.diff_blocks, "left"),
                "right": self._render_side(result.diff_blocks, "right")
            }
    
    def _render_side(self, blocks: List[DiffBlock], side: str) -> str:
        html_parts = []
        
        for block in blocks:
            content = block.left_content if side == "left" else block.right_content
            
            if content is None:
                continue
                
            escaped = content.replace('&', '&amp;').replace('<', '&lt;').replace('>', '&gt;')
            escaped = escaped.replace('\n', '<br>')
            
            if block.type == ChangeType.UNCHANGED:
                html_parts.append(f'<span class="unchanged">{escaped}</span>')
            elif block.type == ChangeType.DELETED and side == "left":
                html_parts.append(f'<span class="deleted" style="background:#ffcccc;text-decoration:line-through;">{escaped}</span>')
            elif block.type == ChangeType.INSERTED and side == "right":
                html_parts.append(f'<span class="inserted" style="background:#ccffcc;">{escaped}</span>')
            elif block.type == ChangeType.MODIFIED:
                if side == "left":
                    html_parts.append(f'<span class="modified-old" style="background:#ffcccc;text-decoration:line-through;">{escaped}</span>')
                else:
                    html_parts.append(f'<span class="modified-new" style="background:#ccffcc;">{escaped}</span>')
        
        return "".join(html_parts)
Python
Copy
# backend/app/main.py
from fastapi import FastAPI, UploadFile, File, HTTPException
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
import uuid
import os
from typing import Optional

from .models import ComparisonResult, FileUploadResponse
from .services.file_extractor import FileExtractor
from .services.comparator import DocumentComparator

app = FastAPI(
    title="Document Comparator API",
    description="API para compara√ß√£o de documentos PDF e Word",
    version="1.0.0"
)

# CORS para desenvolvimento
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000", "http://localhost:5173"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Storage tempor√°rio em mem√≥ria (em produ√ß√£o usar S3/DB)
temp_storage = {}
extractor = FileExtractor()
comparator = DocumentComparator()

@app.post("/api/upload", response_model=FileUploadResponse)
async def upload_file(file: UploadFile = File(...)):
    """Upload e extra√ß√£o de texto de documentos."""
    allowed_extensions = {'.pdf', '.docx', '.doc'}
    file_ext = os.path.splitext(file.filename)[1].lower()
    
    if file_ext not in allowed_extensions:
        raise HTTPException(400, f"Tipo de arquivo n√£o suportado. Use: {allowed_extensions}")
    
    content = await file.read()
    if len(content) > 50 * 1024 * 1024:  # 50MB limit
        raise HTTPException(400, "Arquivo muito grande (m√°x 50MB)")
    
    try:
        if file_ext == '.pdf':
            text = extractor.extract_pdf(content)
            file_type = "pdf"
        else:
            text = extractor.extract_docx(content)
            file_type = "docx"
        
        text = extractor.clean_text(text)
        file_id = str(uuid.uuid4())
        
        temp_storage[file_id] = {
            "filename": file.filename,
            "text": text,
            "content": content
        }
        
        return FileUploadResponse(
            file_id=file_id,
            filename=file.filename,
            file_type=file_type,
            text_preview=text[:500] + "..." if len(text) > 500 else text,
            char_count=len(text)
        )
        
    except Exception as e:
        raise HTTPException(500, f"Erro ao processar arquivo: {str(e)}")

@app.post("/api/compare", response_model=ComparisonResult)
async def compare_documents(
    left_file_id: str,
    right_file_id: str,
    output_format: Optional[str] = "json"  # json, html, redline
):
    """Compara dois documentos previamente enviados."""
    if left_file_id not in temp_storage or right_file_id not in temp_storage:
        raise HTTPException(404, "Arquivo(s) n√£o encontrado(s). Fa√ßa o upload primeiro.")
    
    left_doc = temp_storage[left_file_id]
    right_doc = temp_storage[right_file_id]
    
    try:
        result = comparator.compare(left_doc["text"], right_doc["text"])
        
        if output_format == "html":
            html_result = comparator.generate_redline_html(result)
            return JSONResponse({
                "comparison": result.dict(),
                "html": html_result
            })
        
        return result
        
    except Exception as e:
        raise HTTPException(500, f"Erro na compara√ß√£o: {str(e)}")

@app.get("/api/health")
async def health_check():
    return {"status": "healthy", "version": "1.0.0"}

@app.delete("/api/files/{file_id}")
async def delete_file(file_id: str):
    """Remove arquivo tempor√°rio."""
    if file_id in temp_storage:
        del temp_storage[file_id]
    return {"message": "Arquivo removido"}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
üé® Frontend (React + TypeScript)
TypeScript
Copy
// frontend/src/types/index.ts
export interface FileUploadResponse {
  file_id: string;
  filename: string;
  file_type: 'pdf' | 'docx';
  text_preview: string;
  char_count: number;
}

export interface DiffBlock {
  type: 'inserted' | 'deleted' | 'unchanged' | 'modified';
  left_content: string | null;
  right_content: string | null;
  left_start: number;
  left_end: number;
  right_start: number;
  right_end: number;
}

export interface ComparisonResult {
  similarity_score: number;
  total_changes: number;
  additions: number;
  deletions: number;
  modifications: number;
  diff_blocks: DiffBlock[];
  left_text: string;
  right_text: string;
  processing_time_ms: number;
}

export interface ComparisonState {
  leftFile: FileUploadResponse | null;
  rightFile: FileUploadResponse | null;
  result: ComparisonResult | null;
  loading: boolean;
  error: string | null;
}
TypeScript
Copy
// frontend/src/services/api.ts
import axios from 'axios';

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api';

const api = axios.create({
  baseURL: API_URL,
  headers: {
    'Content-Type': 'multipart/form-data',
  },
});

export const uploadFile = async (file: File) => {
  const formData = new FormData();
  formData.append('file', file);
  
  const response = await api.post('/upload', formData, {
    headers: { 'Content-Type': 'multipart/form-data' },
  });
  return response.data;
};

export const compareDocuments = async (leftFileId: string, rightFileId: string) => {
  const response = await api.post('/compare', null, {
    params: { left_file_id: leftFileId, right_file_id: rightFileId },
  });
  return response.data;
};
tsx
Copy
// frontend/src/components/FileUploader.tsx
import React, { useCallback } from 'react';
import { useDropzone } from 'react-dropzone';
import { Upload, FileText, CheckCircle } from 'lucide-react';
import { motion } from 'framer-motion';

interface FileUploaderProps {
  side: 'left' | 'right';
  onUpload: (file: File) => void;
  uploadedFile: { filename: string; char_count: number } | null;
  isUploading: boolean;
}

export const FileUploader: React.FC<FileUploaderProps> = ({
  side,
  onUpload,
  uploadedFile,
  isUploading
}) => {
  const onDrop = useCallback((acceptedFiles: File[]) => {
    if (acceptedFiles.length > 0) {
      onUpload(acceptedFiles[0]);
    }
  }, [onUpload]);

  const { getRootProps, getInputProps, isDragActive } = useDropzone({
    onDrop,
    accept: {
      'application/pdf': ['.pdf'],
      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],
      'application/msword': ['.doc']
    },
    maxFiles: 1,
    disabled: isUploading
  });

  const bgColor = side === 'left' ? 'from-blue-50 to-indigo-50' : 'from-emerald-50 to-teal-50';
  const borderColor = side === 'left' ? 'border-blue-400' : 'border-emerald-400';
  const accentColor = side === 'left' ? 'text-blue-600' : 'text-emerald-600';

  return (
    <motion.div 
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="w-full"
    >
      <div className={`mb-4 flex items-center justify-between ${accentColor}`}>
        <h3 className="text-lg font-semibold flex items-center gap-2">
          <FileText size={20} />
          {side === 'left' ? 'Documento Original' : 'Documento Revisado'}
        </h3>
        {uploadedFile && (
          <span className="text-sm bg-white px-3 py-1 rounded-full shadow-sm">
            {uploadedFile.char_count.toLocaleString()} caracteres
          </span>
        )}
      </div>

      {!uploadedFile ? (
        <div
          {...getRootProps()}
          className={`
            relative overflow-hidden rounded-2xl border-2 border-dashed p-8
            transition-all duration-300 cursor-pointer
            bg-gradient-to-br ${bgColor}
            ${isDragActive ? `border-solid ${borderColor} scale-[1.02]` : 'border-gray-300'}
            ${isUploading ? 'opacity-50 cursor-not-allowed' : 'hover:shadow-lg'}
          `}
        >
          <input {...getInputProps()} />
          
          <div className="flex flex-col items-center gap-4 text-center">
            <motion.div 
              animate={isDragActive ? { scale: 1.1, rotate: 5 } : { scale: 1 }}
              className={`p-4 rounded-full bg-white shadow-md ${accentColor}`}
            >
              <Upload size={32} />
            </motion.div>
            
            <div>
              <p className="text-lg font-medium text-gray-700">
                {isDragActive ? 'Solte o arquivo aqui' : 'Arraste seu arquivo'}
              </p>
              <p className="text-sm text-gray-500 mt-1">
                ou clique para selecionar
              </p>
              <p className="text-xs text-gray-400 mt-2">
                PDF, DOCX ou DOC (m√°x. 50MB)
              </p>
            </div>
          </div>

          {isUploading && (
            <div className="absolute inset-0 flex items-center justify-center bg-white/80">
              <motion.div 
                animate={{ rotate: 360 }}
                transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                className="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"
              />
            </div>
          )}
        </div>
      ) : (
        <motion.div 
          initial={{ scale: 0.9, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className="bg-white rounded-2xl p-6 shadow-lg border border-gray-100"
        >
          <div className="flex items-start gap-4">
            <div className={`p-3 rounded-xl ${side === 'left' ? 'bg-blue-100' : 'bg-emerald-100'}`}>
              <FileText className={accentColor} size={24} />
            </div>
            <div className="flex-1 min-w-0">
              <h4 className="font-semibold text-gray-800 truncate">
                {uploadedFile.filename}
              </h4>
              <div className="flex items-center gap-2 mt-2 text-green-600">
                <CheckCircle size={16} />
                <span className="text-sm">Pronto para comparar</span>
              </div>
            </div>
          </div>
        </motion.div>
      )}
    </motion.div>
  );
};
tsx
Copy
// frontend/src/components/ComparisonView.tsx
import React from 'react';
import { motion } from 'framer-motion';
import { ComparisonResult, DiffBlock } from '../types';
import { ArrowRightLeft, Percent, FileEdit, Plus, Minus } from 'lucide-react';

interface ComparisonViewProps {
  result: ComparisonResult;
}

const DiffBlockComponent: React.FC<{ block: DiffBlock }> = ({ block }) => {
  const getStyles = (type: string) => {
    switch (type) {
      case 'deleted':
        return 'bg-red-100 text-red-800 line-through decoration-red-500';
      case 'inserted':
        return 'bg-green-100 text-green-800';
      case 'modified':
        return 'bg-yellow-100 text-yellow-800';
      default:
        return '';
    }
  };

  const content = block.left_content || block.right_content || '';
  
  return (
    <span 
      className={`inline rounded px-1 py-0.5 transition-colors ${getStyles(block.type)}`}
      title={`${block.type} | Pos: ${block.left_start}-${block.left_end}`}
    >
      {content}
    </span>
  );
};

export const ComparisonView: React.FC<ComparisonViewProps> = ({ result }) => {
  const { similarity_score, total_changes, additions, deletions, diff_blocks } = result;

  return (
    <motion.div 
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="space-y-6"
    >
      {/* Stats Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <StatCard 
          icon={<Percent size={20} />}
          label="Similaridade"
          value={`${similarity_score.toFixed(1)}%`}
          color="blue"
        />
        <StatCard 
          icon={<FileEdit size={20} />}
          label="Altera√ß√µes"
          value={total_changes}
          color="purple"
        />
        <StatCard 
          icon={<Plus size={20} />}
          label="Adi√ß√µes"
          value={additions}
          color="green"
        />
        <StatCard 
          icon={<Minus size={20} />}
          label="Remo√ß√µes"
          value={deletions}
          color="red"
        />
      </div>

      {/* Comparison Panels */}
      <div className="grid md:grid-cols-2 gap-6">
        {/* Left Side */}
        <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200">
          <div className="bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4">
            <h3 className="text-white font-semibold flex items-center gap-2">
              <ArrowRightLeft size={18} />
              Vers√£o Original
            </h3>
          </div>
          <div className="p-6 font-mono text-sm leading-relaxed whitespace-pre-wrap max-h-[600px] overflow-y-auto">
            {diff_blocks.map((block, idx) => (
              block.left_content && (
                <span 
                  key={`left-${idx}`}
                  className={block.type === 'deleted' || block.type === 'modified' 
                    ? 'bg-red-100 text-red-800 line-through decoration-2 decoration-red-500 px-1 rounded' 
                    : ''}
                >
                  {block.left_content}
                </span>
              )
            ))}
          </div>
        </div>

        {/* Right Side */}
        <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200">
          <div className="bg-gradient-to-r from-emerald-500 to-emerald-600 px-6 py-4">
            <h3 className="text-white font-semibold flex items-center gap-2">
              <ArrowRightLeft size={18} />
              Vers√£o Revisada
            </h3>
          </div>
          <div className="p-6 font-mono text-sm leading-relaxed whitespace-pre-wrap max-h-[600px] overflow-y-auto">
            {diff_blocks.map((block, idx) => (
              block.right_content && (
                <span 
                  key={`right-${idx}`}
                  className={block.type === 'inserted' || block.type === 'modified'
                    ? 'bg-green-100 text-green-800 px-1 rounded border-b-2 border-green-500' 
                    : ''}
                >
                  {block.right_content}
                </span>
              )
            ))}
          </div>
        </div>
      </div>

      {/* Processing Info */}
      <div className="text-center text-sm text-gray-500">
        Processado em {result.processing_time_ms}ms
      </div>
    </motion.div>
  );
};

const StatCard: React.FC<{
  icon: React.ReactNode;
  label: string;
  value: string | number;
  color: 'blue' | 'purple' | 'green' | 'red';
}> = ({ icon, label, value, color }) => {
  const colors = {
    blue: 'from-blue-500 to-blue-600',
    purple: 'from-purple-500 to-purple-600',
    green: 'from-green-500 to-green-600',
    red: 'from-red-500 to-red-600'
  };

  return (
    <motion.div 
      whileHover={{ scale: 1.05 }}
      className="bg-white rounded-xl p-4 shadow-md border border-gray-100"
    >
      <div className={`w-10 h-10 rounded-lg bg-gradient-to-br ${colors[color]} flex items-center justify-center text-white mb-3`}>
        {icon}
      </div>
      <p className="text-2xl font-bold text-gray-800">{value}</p>
      <p className="text-sm text-gray-500">{label}</p>
    </motion.div>
  );
};
tsx
Copy
// frontend/src/App.tsx
import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { FileUploader } from './components/FileUploader';
import { ComparisonView } from './components/ComparisonView';
import { uploadFile, compareDocuments } from './services/api';
import { FileUploadResponse, ComparisonResult } from './types';
import { GitCompare, Sparkles, Shield, Zap } from 'lucide-react';

function App() {
  const [leftFile, setLeftFile] = useState<FileUploadResponse | null>(null);
  const [rightFile, setRightFile] = useState<FileUploadResponse | null>(null);
  const [result, setResult] = useState<ComparisonResult | null>(null);
  const [loading, setLoading] = useState({ upload: false, compare: false });
  const [error, setError] = useState<string | null>(null);

  const handleUpload = async (side: 'left' | 'right', file: File) => {
    setLoading(prev => ({ ...prev, upload: true }));
    setError(null);
    
    try {
      const response = await uploadFile(file);
      if (side === 'left') {
        setLeftFile(response);
      } else {
        setRightFile(response);
      }
    } catch (err) {
      setError('Erro ao fazer upload do arquivo');
    } finally {
      setLoading(prev => ({ ...prev, upload: false }));
    }
  };

  const handleCompare = async () => {
    if (!leftFile || !rightFile) return;
    
    setLoading(prev => ({ ...prev, compare: true }));
    setError(null);
    
    try {
      const comparison = await compareDocuments(leftFile.file_id, rightFile.file_id);
      setResult(comparison);
    } catch (err) {
      setError('Erro ao comparar documentos');
    } finally {
      setLoading(prev => ({ ...prev, compare: false }));
    }
  };

  const canCompare = leftFile && rightFile && !loading.upload;

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50">
      {/* Header */}
      <header className="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="bg-gradient-to-br from-blue-600 to-indigo-600 p-2 rounded-xl">
              <GitCompare className="text-white" size={28} />
            </div>
            <div>
              <h1 className="text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                DocCompare
              </h1>
              <p className="text-xs text-gray-500">Compara√ß√£o inteligente de documentos</p>
            </div>
          </div>
          
          <nav className="hidden md:flex items-center gap-6">
            <span className="flex items-center gap-2 text-sm text-gray-600">
              <Shield size={16} /> Seguro
            </span>
            <span className="flex items-center gap-2 text-sm text-gray-600">
              <Zap size={16} /> R√°pido
            </span>
            <span className="flex items-center gap-2 text-sm text-gray-600">
              <Sparkles size={16} /> Preciso
            </span>
          </nav>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-6 py-12">
        <AnimatePresence mode="wait">
          {!result ? (
            <motion.div 
              key="upload"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="space-y-8"
            >
              <div className="text-center max-w-2xl mx-auto mb-12">
                <h2 className="text-4xl font-bold text-gray-800 mb-4">
                  Compare documentos em segundos
                </h2>
                <p className="text-lg text-gray-600">
                  Identifique todas as altera√ß√µes entre vers√µes de contratos, propostas e documentos legais 
                  com precis√£o profissional.
                </p>
              </div>

              <div className="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <FileUploader
                  side="left"
                  onUpload={(file) => handleUpload('left', file)}
                  uploadedFile={leftFile}
                  isUploading={loading.upload}
                />
                
                <div className="hidden md:flex items-center justify-center">
                  <motion.div 
                    animate={{ x: [0, 10, 0] }}
                    transition={{ duration: 2, repeat: Infinity }}
                    className="text-gray-400"
                  >
                    <GitCompare size={32} />
                  </motion.div>
                </div>

                <FileUploader
                  side="right"
                  onUpload={(file) => handleUpload('right', file)}
                  uploadedFile={rightFile}
                  isUploading={loading.upload}
                />
              </div>

              {error && (
                <motion.div 
                  initial={{ opacity: 0, y: -10 }}
                  animate={{ opacity: 1, y: 0 }}
                  className="max-w-md mx-auto p-4 bg-red-50 border border-red-200 rounded-xl text-red-700 text-center"
                >
                  {error}
                </motion.div>
              )}

              <div className="flex justify-center pt-8">
                <motion.button
                  whileHover={canCompare ? { scale: 1.05 } : {}}
                  whileTap={canCompare ? { scale: 0.95 } : {}}
                  onClick={handleCompare}
                  disabled={!canCompare || loading.compare}
                  className={`
                    px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl transition-all
                    ${canCompare 
                      ? 'bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:shadow-2xl hover:from-blue-700 hover:to-indigo-700' 
                      : 'bg-gray-200 text-gray-400 cursor-not-allowed'}
                  `}
                >
                  {loading.compare ? (
                    <span className="flex items-center gap-2">
                      <motion.div 
                        animate={{ rotate: 360 }}
                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                        className="w-5 h-5 border-2 border-white border-t-transparent rounded-full"
                      />
                      Comparando...
                    </span>
                  ) : (
                    'Comparar Documentos'
                  )}
                </motion.button>
              </div>
            </motion.div>
          ) : (
            <motion.div key="result" initial={{ opacity: 0 }} animate={{ opacity: 1 }}>
              <div className="flex justify-between items-center mb-8">
                <h2 className="text-2xl font-bold text-gray-800">Resultado da Compara√ß√£o</h2>
                <button
                  onClick={() => {
                    setResult(null);
                    setLeftFile(null);
                    setRightFile(null);
                  }}
                  className="px-4 py-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
                >
                  Nova Compara√ß√£o
                </button>
              </div>
              <ComparisonView result={result} />
            </motion.div>
          )}
        </AnimatePresence>
      </main>
    </div>
  );
}

export default App;
JSON
Copy
// frontend/package.json
{
  "name": "document-comparator-frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "axios": "^1.6.2",
    "react-dropzone": "^14.2.3",
    "framer-motion": "^10.16.16",
    "lucide-react": "^0.294.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@vitejs/plugin-react": "^4.2.1",
    "autoprefixer": "^10.4.16",
    "postcss": "^8.4.32",
    "tailwindcss": "^3.3.6",
    "typescript": "^5.2.2",
    "vite": "^5.0.8"
  }
}
TypeScript
Copy
// frontend/tailwind.config.js
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
        mono: ['JetBrains Mono', 'Fira Code', 'monospace'],
      },
      animation: {
        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
      }
    },
  },
  plugins: [],
}
üê≥ Docker & Deploy
dockerfile
Copy
# backend/Dockerfile
FROM python:3.11-slim

WORKDIR /app

RUN apt-get update && apt-get install -y \
    gcc \
    libffi-dev \
    && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY app/ ./app/

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
yaml
Copy
# docker-compose.yml
version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      - UVICORN_WORKERS=4
    volumes:
      - ./backend/app:/app/app
    restart: unless-stopped

  frontend:
    build: ./frontend
    ports:
      - "3000:80"
    depends_on:
      - backend
    restart: unless-stopped
üöÄ Como Executar
bash
Copy
# 1. Clone e entre no diret√≥rio
git clone <repo> && cd document-comparator

# 2. Backend
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
uvicorn app.main:app --reload

# 3. Frontend (novo terminal)
cd frontend
npm install
npm run dev

# 4. Acesse http://localhost:5173
‚ú® Funcionalidades Implementadas
Table
Copy
Feature	Descri√ß√£o
Upload Inteligente	Drag-and-drop com preview de texto extra√≠do
Extra√ß√£o Avan√ßada	PDF (PyMuPDF) + Word (python-docx) com preserva√ß√£o de estrutura
Compara√ß√£o Precisa	Algoritmo h√≠brido (difflib + diff-match-patch)
Visualiza√ß√£o Redline	Highlight de inser√ß√µes (verde), dele√ß√µes (vermelho) e modifica√ß√µes (amarelo)
M√©tricas	Score de similaridade, contagem de altera√ß√µes
Performance	Processamento ass√≠ncrono com tempos < 1s para docs m√©dios
Pr√≥ximos passos para produ√ß√£o:
Adicionar autentica√ß√£o JWT
Implementar fila de processamento (Celery + Redis)
Storage persistente (AWS S3)
Exportar resultados para PDF/Word com track changes
Modo "mesclar altera√ß√µes" (accept/reject)